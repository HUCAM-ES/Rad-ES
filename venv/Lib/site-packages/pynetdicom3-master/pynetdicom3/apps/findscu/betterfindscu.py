#!/usr/bin/env python

"""
    A dcmtk style findscu application.

    Used for
"""

import argparse
import logging
import os
import socket
import sys
import time

from pydicom import read_file
from pydicom.dataset import Dataset
from pydicom.uid import ExplicitVRLittleEndian, ImplicitVRLittleEndian, \
    ExplicitVRBigEndian

from pynetdicom3 import AE, QueryRetrieveSOPClassList


# Create application entity
# Binding to port 0 lets the OS pick an available port
ae = AE(ae_title='projetoDoses',
        port=0,
        scu_sop_class=QueryRetrieveSOPClassList)

# Request association with remote
assoc = ae.associate('10.5.136.10', 4096, 'server-dicom')

if assoc.is_established:
   
    # Create query dataset
    dataset = Dataset()
    dataset.PatientName = '*COELHO SILVA ENIREU*'
    print(dataset.PatientName)
    dataset.QueryRetrieveLevel = "PATIENT"

  
    query_model = 'P'
    

    # Send query
    response = assoc.send_c_find(dataset, query_model=query_model)

    time.sleep(1)
    for (value, dataset) in response:
        #pass
        print(dataset)

    assoc.release()

ae.quit()
